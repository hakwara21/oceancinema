<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة التحكم - إدارة الأفلام</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
</head>
<body class="bg-gray-900 text-white">
    <!-- Navigation -->
    <nav class="bg-gray-800 p-4 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold flex items-center gap-2">
                <i data-feather="settings" class="w-6 h-6"></i>
                لوحة تحكم الأفلام
            </h1>
            <div class="flex gap-4">
                <a href="index.html" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg transition duration-300 flex items-center gap-2">
                    <i data-feather="home" class="w-4 h-4"></i>
                    العودة للرئيسية
                </a>
                <button onclick="logout()" class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg transition duration-300 flex items-center gap-2">
                    <i data-feather="log-out" class="w-4 h-4"></i>
                    تسجيل الخروج
                </button>
            </div>
        </div>
    </nav>

    <main class="container mx-auto px-4 py-8">
        <!-- Stats -->
        <section class="mb-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div class="bg-gray-800 p-6 rounded-2xl border border-gray-700">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">إجمالي الأفلام</p>
                            <h3 class="text-3xl font-bold mt-2" id="totalMovies">0</h3>
                        </div>
                        <div class="bg-blue-500/20 p-3 rounded-full">
                            <i data-feather="film" class="w-6 h-6 text-blue-500"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-800 p-6 rounded-2xl border border-gray-700">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">المستخدمين النشطين</p>
                            <h3 class="text-3xl font-bold mt-2">1,234</h3>
                        </div>
                        <div class="bg-green-500/20 p-3 rounded-full">
                            <i data-feather="users" class="w-6 h-6 text-green-500"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-800 p-6 rounded-2xl border border-gray-700">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">المشاهدات اليوم</p>
                            <h3 class="text-3xl font-bold mt-2">567</h3>
                        </div>
                        <div class="bg-purple-500/20 p-3 rounded-full">
                            <i data-feather="eye" class="w-6 h-6 text-purple-500"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-800 p-6 rounded-2xl border border-gray-700">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-400 text-sm">التقييم المتوسط</p>
                            <h3 class="text-3xl font-bold mt-2">8.2</h3>
                        </div>
                        <div class="bg-yellow-500/20 p-3 rounded-full">
                            <i data-feather="star" class="w-6 h-6 text-yellow-500"></i>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Add Movie Form -->
            <div class="lg:col-span-2">
                <section class="mb-8">
                    <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
                        <i data-feather="plus-circle" class="w-6 h-6 text-green-500"></i>
                        إضافة فيلم جديد
                    </h2>
                    <form id="addMovieForm" class="bg-gray-800 p-6 rounded-2xl border border-gray-700">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Basic Information -->
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-gray-300 mb-2 font-medium">عنوان الفيلم</label>
                                    <input type="text" id="movieTitle" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300" required>
                                </div>
                                <div>
                                    <label class="block text-gray-300 mb-2 font-medium">رابط البوستر</label>
                                    <input type="url" id="moviePoster" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300" required>
                                </div>
                                <div>
                                    <label class="block text-gray-300 mb-2 font-medium">رابط الفيديو</label>
                                    <input type="url" id="movieVideo" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300" required>
                                </div>
                                <div>
                                    <label class="block text-gray-300 mb-2 font-medium">التصنيف</label>
                                    <select id="movieCategory" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300">
                                        <option value="دراما">دراما</option>
                                        <option value="أكشن">أكشن</option>
                                        <option value="كوميدي">كوميدي</option>
                                        <option value="رومانسي">رومانسي</option>
                                        <option value="تشويق">تشويق</option>
                                        <option value="مغامرات">مغامرات</option>
                                        <option value="تاريخي">تاريخي</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Additional Information -->
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-gray-300 mb-2 font-medium">سنة الإنتاج</label>
                                    <input type="number" id="movieYear" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300" required>
                                </div>
                                <div>
                                    <label class="block text-gray-300 mb-2 font-medium">التقييم</label>
                                    <input type="number" step="0.1" id="movieRating" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300" required>
                                </div>
                                <div>
                                    <label class="block text-gray-300 mb-2 font-medium">المخرج</label>
                                    <input type="text" id="movieDirector" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300" required>
                                </div>
                                <div>
                                    <label class="block text-gray-300 mb-2 font-medium">الممثلين (افصل بفاصلة)</label>
                                    <input type="text" id="movieCast" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300" placeholder="أحمد عز, منى زكي, خالد الصاوي">
                                </div>
                            </div>
                        </div>

                        <!-- Description -->
                        <div class="mt-6">
                            <label class="block text-gray-300 mb-2 font-medium">وصف الفيلم</label>
                            <textarea id="movieDescription" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-red-500 transition duration-300" rows="4" placeholder="اكتب وصفاً مفصلاً للفيلم..."></textarea>
                        </div>

                        <!-- Servers -->
                        <div class="mt-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-lg font-bold text-gray-300">سيرفرات المشاهدة</h3>
                                <button type="button" id="addServerBtn" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg transition duration-300 flex items-center gap-2 text-sm">
                                    <i data-feather="plus" class="w-4 h-4"></i>
                                    إضافة سيرفر
                                </button>
                            </div>
                            <div id="serversContainer" class="space-y-3">
                                <!-- سيتم إضافة السيرفرات هنا -->
                            </div>
                        </div>

                        <button type="submit" class="bg-red-600 hover:bg-red-700 px-8 py-4 rounded-xl font-medium mt-6 transition-all duration-300 transform hover:scale-105 w-full flex items-center justify-center gap-2">
                            <i data-feather="save" class="w-5 h-5"></i>
                            إضافة الفيلم
                        </button>
                    </form>
                </section>
            </div>

            <!-- Movies List -->
            <div class="lg:col-span-1">
                <section>
                    <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
                        <i data-feather="list" class="w-6 h-6 text-blue-500"></i>
                        الأفلام المضافة
                    </h2>
                    <div id="moviesList" class="space-y-4 max-h-[800px] overflow-y-auto">
                        <!-- سيتم ملؤها بالجافاسكريبت -->
                    </div>
                </section>
            </div>
        </div>
    </main>

    <script>
        // بيانات الأفلام
        let movies = JSON.parse(localStorage.getItem('movies')) || [];
        let movieIdCounter = parseInt(localStorage.getItem('movieIdCounter')) || 100;

        // تحديث الإحصائيات
        function updateStats() {
            document.getElementById('totalMovies').textContent = movies.length;
        }

        // إضافة سيرفر جديد
        document.getElementById('addServerBtn').addEventListener('click', function() {
            const serversContainer = document.getElementById('serversContainer');
            const serverIndex = serversContainer.children.length;
            
            const serverHtml = `
                <div class="server-item bg-gray-700 p-4 rounded-lg border border-gray-600">
                    <div class="flex gap-3 mb-3">
                        <input type="text" class="flex-1 bg-gray-600 border border-gray-500 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="اسم السيرفر" required>
                        <input type="url" class="flex-1 bg-gray-600 border border-gray-500 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="رابط المشاهدة" required>
                    </div>
                    <div class="flex gap-2 items-center">
                        <select class="flex-1 bg-gray-600 border border-gray-500 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500">
                            <option value="FHD">FHD 1080p</option>
                            <option value="HD">HD 720p</option>
                            <option value="SD">SD 480p</option>
                        </select>
                        <button type="button" class="bg-red-600 hover:bg-red-700 px-3 py-2 rounded-lg transition duration-300 remove-server flex items-center gap-1">
                            <i data-feather="trash-2" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            `;
            
            serversContainer.insertAdjacentHTML('beforeend', serverHtml);
            
            // إضافة event listener لزر الحذف
            serversContainer.lastElementChild.querySelector('.remove-server').addEventListener('click', function() {
                this.closest('.server-item').remove();
            });

            feather.replace();
        });

        // جمع بيانات السيرفرات
        function getServersData() {
            const servers = [];
            const serverItems = document.querySelectorAll('.server-item');
            
            serverItems.forEach(item => {
                const inputs = item.querySelectorAll('input');
                const select = item.querySelector('select');
                
                servers.push({
                    name: inputs[0].value,
                    url: inputs[1].value,
                    quality: select.value
                });
            });
            
            return servers;
        }

        // معالجة إضافة فيلم جديد
        document.getElementById('addMovieForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const movieData = {
                id: movieIdCounter++,
                title: document.getElementById('movieTitle').value,
                posterUrl: document.getElementById('moviePoster').value,
                videoUrl: document.getElementById('movieVideo').value,
                category: document.getElementById('movieCategory').value,
                year: document.getElementById('movieYear').value,
                rating: document.getElementById('movieRating').value,
                director: document.getElementById('movieDirector').value,
                cast: document.getElementById('movieCast').value.split(',').map(actor => actor.trim()).filter(actor => actor),
                description: document.getElementById('movieDescription').value,
                servers: getServersData(),
                duration: "2h 18m",
                language: "العربية",
                country: "مصر",
                quality: "FHD 1080p"
            };
            
            // إضافة الفيلم للقائمة
            movies.push(movieData);
            
            // حفظ في localStorage
            localStorage.setItem('movies', JSON.stringify(movies));
            localStorage.setItem('movieIdCounter', movieIdCounter);
            
            // تحديث العرض
            displayMovies();
            updateStats();
            
            // إعادة تعيين النموذج
            this.reset();
            document.getElementById('serversContainer').innerHTML = '';
            
            showNotification('تم إضافة الفيلم بنجاح!', 'success');
        });

        // عرض الأفلام
        function displayMovies() {
            const moviesList = document.getElementById('moviesList');
            moviesList.innerHTML = '';
            
            if (movies.length === 0) {
                moviesList.innerHTML = `
                    <div class="text-center py-8 text-gray-400">
                        <i data-feather="film" class="w-12 h-12 mx-auto mb-4 opacity-50"></i>
                        <p>لا توجد أفلام مضافة بعد</p>
                    </div>
                `;
                return;
            }
            
            movies.forEach(movie => {
                const movieHtml = `
                    <div class="bg-gray-800 rounded-xl overflow-hidden border border-gray-700 hover:border-gray-600 transition duration-300">
                        <div class="flex">
                            <img src="${movie.posterUrl}" alt="${movie.title}" 
                                 class="w-20 h-24 object-cover"
                                 onerror="this.src='https://via.placeholder.com/80x96/334155/ffffff?text=صورة'">
                            <div class="flex-1 p-4">
                                <div class="flex justify-between items-start mb-2">
                                    <h3 class="font-bold text-white text-sm">${movie.title}</h3>
                                    <span class="bg-red-600 text-white px-2 py-1 rounded text-xs">${movie.rating}</span>
                                </div>
                                <div class="flex justify-between text-xs text-gray-400 mb-3">
                                    <span>${movie.year}</span>
                                    <span>${movie.category}</span>
                                </div>
                                <div class="flex gap-2">
                                    <button class="flex-1 bg-blue-600 hover:bg-blue-700 px-2 py-1 rounded text-xs transition duration-300 edit-movie" data-id="${movie.id}">
                                        تعديل
                                    </button>
                                    <button class="flex-1 bg-red-600 hover:bg-red-700 px-2 py-1 rounded text-xs transition duration-300 delete-movie" data-id="${movie.id}">
                                        حذف
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                moviesList.insertAdjacentHTML('beforeend', movieHtml);
            });
            
            // إضافة event listeners
            document.querySelectorAll('.edit-movie').forEach(btn => {
                btn.addEventListener('click', function() {
                    editMovie(parseInt(this.getAttribute('data-id')));
                });
            });
            
            document.querySelectorAll('.delete-movie').forEach(btn => {
                btn.addEventListener('click', function() {
                    deleteMovie(parseInt(this.getAttribute('data-id')));
                });
            });

            feather.replace();
        }

        // حذف فيلم
        function deleteMovie(movieId) {
            if (confirm('هل أنت متأكد من حذف هذا الفيلم؟')) {
                movies = movies.filter(movie => movie.id !== movieId);
                localStorage.setItem('movies', JSON.stringify(movies));
                displayMovies();
                updateStats();
                showNotification('تم حذف الفيلم بنجاح', 'info');
            }
        }

        // تعديل فيلم
        function editMovie(movieId) {
            const movie = movies.find(m => m.id === movieId);
            if (movie) {
                // نقل البيانات للنموذج
                document.getElementById('movieTitle').value = movie.title;
                document.getElementById('moviePoster').value = movie.posterUrl;
                document.getElementById('movieVideo').value = movie.videoUrl;
                document.getElementById('movieCategory').value = movie.category;
                document.getElementById('movieYear').value = movie.year;
                document.getElementById('movieRating').value = movie.rating;
                document.getElementById('movieDirector').value = movie.director;
                document.getElementById('movieCast').value = movie.cast.join(', ');
                document.getElementById('movieDescription').value = movie.description;
                
                // حذف الفيلم القديم
                movies = movies.filter(m => m.id !== movieId);
                displayMovies();
                updateStats();
                
                showNotification('يمكنك تعديل البيانات وإعادة الإضافة', 'info');
            }
        }

        // عرض الإشعارات
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 left-4 z-50 px-6 py-3 rounded-lg shadow-lg transition-all duration-300 ${
                type === 'success' ? 'bg-green-600' : 'bg-blue-600'
            }`;
            notification.innerHTML = `
                <div class="flex items-center gap-3">
                    <i data-feather="${type === 'success' ? 'check-circle' : 'info'}" class="w-5 h-5"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            feather.replace();
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // تسجيل الخروج
        function logout() {
            if (confirm('هل تريد تسجيل الخروج؟')) {
                window.location.href = 'index.html';
            }
        }

        // التهيئة
        document.addEventListener('DOMContentLoaded', function() {
            displayMovies();
            updateStats();
            feather.replace();
        });
    </script>
</body>
</html>